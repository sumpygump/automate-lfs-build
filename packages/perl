#!/bin/bash

source "$(dirname "$0")"/../common/common_source

NAME=perl
VERSION=$PERL_VER
TARFILE=$NAME-$VERSION.tar.xz
FETCH_URL="https://www.cpan.org/src/5.0/$TARFILE"
mSBU=7100

patchup()
{
    cd "$WORKBENCH/$NAME-$VERSION"
    echo "127.0.0.1 localhost $(hostname)" > /etc/hosts
    export BUILD_ZLIB=False
    export BUILD_BZIP2=0
}

configure()
{
    cd "$WORKBENCH/$NAME-$VERSION"
    BUILD_PATH=$(pwd)
    sh Configure \
        -des \
        -Dprefix=/usr \
        -Dvendorprefix=/usr \
        -Dman1dir=/usr/share/man/man1 \
        -Dman3dir=/usr/share/man/man3 \
        -Dpager="/usr/bin/less -isR" \
        -Duseshrplib -Dusethreads >>"$LOGFILE" 2>&1
}

build()
{
    cd "$BUILD_PATH"
    make $SILENT_MAKE $MAKE_JOBS -ik >>"$LOGFILE" 2>&1
}

build_install()
{
    cd "$BUILD_PATH"
    make -ik $SILENT_MAKE $MAKE_JOBS install >>"$LOGFILE" 2>&1
}

post_build()
{
    unset BUILD_ZLIB BUILD_BZIP2
}

source "$(dirname "$0")"/../common/common_exec
