#!/bin/bash

source "$(dirname "$0")"/../common/common_source

NAME=readline
VERSION=$READLINE_VER
TARFILE=$NAME-$VERSION.tar.gz
FETCH_URL="http://ftp.gnu.org/gnu/readline/$TARFILE"
mSBU=100

patchup()
{
    cd "$WORKBENCH/$NAME-$VERSION"
    sed -i '/MV.*old/d' Makefile.in
    sed -i '/{OLDSUFF}/c:' support/shlib-install
}

configure()
{
    cd "$WORKBENCH/$NAME-$VERSION"
    BUILD_PATH=$(pwd)
    ./configure \
        --prefix=/usr \
        --disable-static \
        --with-curses \
        --docdir=/usr/share/doc/readline-$VERSION >>"$LOGFILE" 2>&1
}

build()
{
    cd "$BUILD_PATH"
    make $SILENT_MAKE $MAKE_JOBS SHLIB_LIBS="-lncursesw" >>"$LOGFILE" 2>&1
}

build_install()
{
    cd "$BUILD_PATH"
    make $SILENT_MAKE $MAKE_JOBS SHLIB_LIBS="-lncursesw" install >>"$LOGFILE" 2>&1
}

post_install()
{
    {
    # Install the documentation
    install -v -m644 doc/*.{ps,pdf,html,dvi} /usr/share/doc/readline-$VERSION
    } >>"$LOGFILE" 2>&1
}

source "$(dirname "$0")"/../common/common_exec
