#!/bin/bash

source "$(dirname "$0")"/../common/common_source

NAME=busybox
VERSION=${BUSYBOX_VER}
TARFILE=$NAME-$VERSION.tar.bz2
FETCH_URL="https://busybox.net/downloads/$TARFILE"
mSBU=1200

configure()
{
    cd "$TMP"/"$NAME"-"$VERSION"
    mkdir build

    make O=build defconfig >>"$LOGFILE" 2>&1

    cp "/automate-lfs-build/config/busybox_config" build/.config
    [ $? -ne 0 ] && return 1

    cd build
    BUILD_PATH=$(pwd)
}

post_install()
{
    cd "$BUILD_PATH"
    {
        cp -rv _install/bin/* /bin/
        cp -rv _install/sbin/* /sbin/
        cp -rv _install/usr/bin/* /usr/bin/
        cp -rv _install/usr/sbin/* /usr/sbin/

        rm /bin/sh
        ln -s /bin/bash /bin/sh
    } >>"$LOGFILE" 2>&1
}

source "$(dirname "$0")"/../common/common_exec
