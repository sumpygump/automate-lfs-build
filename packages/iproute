#!/bin/bash

source "$(dirname "$0")"/../common/common_source

NAME=iproute2
VERSION=$IPROUTE_VER
TARFILE=$NAME-$VERSION.tar.xz
FETCH_URL="https://www.kernel.org/pub/linux/utils/net/iproute2/$TARFILE"
mSBU=200

patchup()
{
    cd "$WORKBENCH/$NAME-$VERSION"

    # Prevent building arpd as it requires berkeley db
    sed -i /ARPD/d Makefile
    rm -f man/man8/arpd.8

    # Disable building two modules that required iptables
    sed -i 's/.m_ipt.o//' tc/Makefile
}

configure()
{
    cd "$WORKBENCH/$NAME-$VERSION"
    BUILD_PATH=$(pwd)
}

build_install()
{
    make $SILENT_MAKE $MAKE_JOBS SBINDIR=/usr/bin install >>"$LOGFILE" 2>&1

    mkdir -v /usr/share/doc/iproute2-$VERSION
    cp -vf COPYING README* /usr/share/doc/iproute2-$VERSION >>"$LOGFILE" 2>&1
}

source "$(dirname "$0")"/../common/common_exec
